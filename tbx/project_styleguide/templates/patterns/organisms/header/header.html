{% load wagtailcore_tags wagtail_cache navigation_tags %}
{% wagtail_site as current_site %}
<header class="header grid">
    {% include "patterns/atoms/skip-link/skip-link.html" %}
    <a href="/" aria-label="Homepage link" class="grid__header-logo header__logo-link">
        {% include "patterns/atoms/icons/icon.html" with name="logo" classname="logo" %}
    </a>
    <div class="grid__header-nav">
        {# Desktop navigation #}
        <nav aria-label="Main navigation" class="primary-nav-desktop" data-desktop-menu>
            {% wagtailcache 600 "primarynav" current_site.pk is_pattern_library %}
                <ul data-primary-nav class="primary-nav-desktop__list">
                    {% primarynav %}
                </ul>
            {% endwagtailcache %}
        </nav>
    </div>
    {# Site switcher #}
    <form class="site-switcher" data-mode-switcher method="GET" action="{% url 'switch_mode' %}">
        <fieldset>
            <legend>Toggle light or dark mode</legend>
            <label for="id-site-switcher-light" class="site-switcher__label">Switch to light mode</label>
            <input
                type="radio"
                name="switch_mode"
                value="light"
                class="site-switcher__checkbox"
                id="id-site-switcher-light"
                data-mode-switch
                {% if MODE == 'light' %}checked="checked"{% endif %}
            >
            <input
                type="radio"
                name="switch_mode"
                value="dark"
                class="site-switcher__checkbox"
                id="id-site-switcher-dark"
                data-mode-switch
                {% if MODE == 'dark' %}checked="checked"{% endif %}
            >
            <label for="id-site-switcher-dark" class="site-switcher__label">Switch to dark mode</label>
            <input type="hidden" name="next_url" value="{{ request.get_full_path }}">
            <noscript>
                <input type="submit" class="button">
            </noscript>
        </fieldset>
    </form>

    {# Mobile menu toggle #}
    <div class="header__menu-toggle grid__header-toggle">
        <span class="sr-only">Menu</span>
        <button class="button-menu-toggle" data-mobile-menu-toggle aria-haspopup="true" aria-expanded="false" aria-label="Mobile menu toggle">
            <span class="button-menu-toggle__line"></span>
            <span class="button-menu-toggle__line"></span>
            <span class="button-menu-toggle__line"></span>
            <span class="button-menu-toggle__line"></span>
        </button>
    </div>

    {# Mobile navigation #}
    <nav aria-label="Main navigation"  class="primary-nav-mobile" data-mobile-menu>
        {% wagtailcache 600 "primarynavmobile" current_site.pk is_pattern_library %}
            <ul data-primary-nav class="primary-nav-mobile__list">
                {% primarynavmobile %}
            </ul>
        {% endwagtailcache %}
    </nav>
</header>
